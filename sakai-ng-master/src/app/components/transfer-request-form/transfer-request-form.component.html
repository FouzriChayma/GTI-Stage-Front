<div class="min-h-screen bg-gray-50 dark:bg-gray-900 p-4">
  <div class="enhanced-card hover-glow smooth-transition">
    <div class="enhanced-toolbar">
      <div class="toolbar-left">
        <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Initiate Transfer Request</h3>
      </div>
      <div class="toolbar-right">
        <button
          pButton
          pRipple
          label="Save"
          icon="pi pi-check"
          class="btn-success smooth-transition hover-lift"
          [disabled]="transferForm.invalid || isSaving"
          (click)="saveTransferRequest()"
        ></button>
        <button
          pButton
          pRipple
          label="Cancel"
          icon="pi pi-times"
          class="btn-secondary smooth-transition hover-lift"
          (click)="cancel()"
        ></button>
      </div>
    </div>
  </div>

  <form [formGroup]="transferForm" class="space-y-6 fade-in smooth-transition">
    <!-- Basic Information -->
    <div class="form-section hover-glow smooth-transition">
      <h5 class="form-section-title">Basic Information</h5>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        <div class="form-field">
          <label for="commissionAccountNumber" class="form-label form-required">Commission Account Number</label>
          <input
            pInputText
            id="commissionAccountNumber"
            formControlName="commissionAccountNumber"
            placeholder="Enter commission account number"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('commissionAccountNumber')?.touched && transferForm.get('commissionAccountNumber')?.invalid">
            Commission Account is required (10-34 characters)
          </small>
        </div>
        <div class="form-field">
          <label for="commissionAccountType" class="form-label form-required">Commission Account Type</label>
          <p-dropdown
            id="commissionAccountType"
            [options]="accountTypes"
            formControlName="commissionAccountType"
            optionLabel="label"
            optionValue="value"
            placeholder="Select account type"
            styleClass="w-full"
          ></p-dropdown>
          <small class="p-error" *ngIf="transferForm.get('commissionAccountType')?.touched && transferForm.get('commissionAccountType')?.invalid">
            Commission Account Type is required
          </small>
        </div>
        <div class="form-field">
          <label for="settlementAccountNumber" class="form-label form-required">Settlement Account Number</label>
          <input
            pInputText
            id="settlementAccountNumber"
            formControlName="settlementAccountNumber"
            placeholder="Enter settlement account number"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('settlementAccountNumber')?.touched && transferForm.get('settlementAccountNumber')?.invalid">
            Settlement Account is required (10-34 characters)
          </small>
        </div>
        <div class="form-field">
          <label for="settlementAccountType" class="form-label form-required">Settlement Account Type</label>
          <p-dropdown
            id="settlementAccountType"
            [options]="accountTypes"
            formControlName="settlementAccountType"
            optionLabel="label"
            optionValue="value"
            placeholder="Select account type"
            styleClass="w-full"
          ></p-dropdown>
          <small class="p-error" *ngIf="transferForm.get('settlementAccountType')?.touched && transferForm.get('settlementAccountType')?.invalid">
            Settlement Account Type is required
          </small>
        </div>
      </div>
    </div>

    <!-- Transfer Details -->
    <div class="form-section hover-glow smooth-transition">
      <h5 class="form-section-title">Transfer Details</h5>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        <div class="form-field">
          <label for="transferType" class="form-label form-required">Transfer Type</label>
          <p-dropdown
            id="transferType"
            [options]="transferTypes"
            formControlName="transferType"
            optionLabel="label"
            optionValue="value"
            placeholder="Select transfer type"
            styleClass="w-full"
            (onChange)="onTransferTypeChange()"
          ></p-dropdown>
          <small class="p-error" *ngIf="transferForm.get('transferType')?.touched && transferForm.get('transferType')?.invalid">
            Transfer Type is required
          </small>
        </div>
        <div class="form-field">
          <label for="issueDate" class="form-label form-required">Issue Date</label>
          <input
            pInputText
            id="issueDate"
            formControlName="issueDate"
            type="date"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('issueDate')?.touched && transferForm.get('issueDate')?.invalid">
            Issue Date is required and cannot be in the future
          </small>
        </div>
        <div class="form-field">
          <label for="feeType" class="form-label form-required">Fee Type</label>
          <p-dropdown
            id="feeType"
            [options]="feeTypes"
            formControlName="feeType"
            optionLabel="label"
            optionValue="value"
            placeholder="Select fee type"
            styleClass="w-full"
          ></p-dropdown>
          <small class="p-error" *ngIf="transferForm.get('feeType')?.touched && transferForm.get('feeType')?.invalid">
            Fee Type is required
          </small>
        </div>
        <div class="form-field">
          <label for="currency" class="form-label form-required">Currency</label>
          <input
            pInputText
            id="currency"
            formControlName="currency"
            placeholder="e.g., TND"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('currency')?.touched && transferForm.get('currency')?.invalid">
            Currency must be a 3-letter ISO 4217 code
          </small>
        </div>
        <div class="form-field">
          <label for="amount" class="form-label form-required">Amount</label>
          <p-inputNumber
            id="amount"
            formControlName="amount"
            [min]="0.001"
            mode="currency"
            currency="TND"
            placeholder="Enter amount"
            styleClass="w-full"
          ></p-inputNumber>
          <small class="p-error" *ngIf="transferForm.get('amount')?.touched && transferForm.get('amount')?.invalid">
            Amount must be greater than 0.001
          </small>
        </div>
      </div>
    </div>

    <!-- Commercial Transfer Information -->
    <div *ngIf="transferForm.get('transferType')?.value === 'COMMERCIAL'" class="form-section fade-in smooth-transition">
      <h5 class="form-section-title">Commercial Transfer Information</h5>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="form-field">
          <label for="invoiceNumber" class="form-label form-required">Invoice Number</label>
          <input
            pInputText
            id="invoiceNumber"
            formControlName="invoiceNumber"
            placeholder="Enter invoice number"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('invoiceNumber')?.touched && transferForm.get('invoiceNumber')?.invalid">
            Invoice Number is required (max 50 characters)
          </small>
        </div>
        <div class="form-field">
          <label for="invoiceDate" class="form-label form-required">Invoice Date</label>
          <input
            pInputText
            id="invoiceDate"
            formControlName="invoiceDate"
            type="date"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('invoiceDate')?.touched && transferForm.get('invoiceDate')?.invalid">
            Invoice Date is required and cannot be in the future
          </small>
        </div>
        <div class="form-field md:col-span-2">
          <label for="transferReason" class="form-label form-required">Transfer Reason</label>
          <input
            pInputText
            id="transferReason"
            formControlName="transferReason"
            placeholder="Enter transfer reason"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('transferReason')?.touched && transferForm.get('transferReason')?.invalid">
            Transfer Reason is required (max 255 characters)
          </small>
        </div>
      </div>
    </div>

    <!-- Beneficiary Information -->
    <div class="form-section hover-glow smooth-transition">
      <h5 class="form-section-title">Beneficiary Information</h5>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="form-field">
          <label for="beneficiaryName" class="form-label form-required">Beneficiary Name</label>
          <input
            pInputText
            id="beneficiaryName"
            formControlName="beneficiaryName"
            placeholder="Enter beneficiary name"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('beneficiaryName')?.touched && transferForm.get('beneficiaryName')?.invalid">
            Beneficiary Name is required (max 100 characters)
          </small>
        </div>
        <div class="form-field">
          <label for="beneficiaryCountry" class="form-label form-required">Country</label>
          <input
            pInputText
            id="beneficiaryCountry"
            formControlName="beneficiaryCountry"
            placeholder="Enter country"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('beneficiaryCountry')?.touched && transferForm.get('beneficiaryCountry')?.invalid">
            Country is required (max 100 characters)
          </small>
        </div>
        <div class="form-field">
          <label for="beneficiaryDestinationBank" class="form-label form-required">Destination Bank</label>
          <input
            pInputText
            id="beneficiaryDestinationBank"
            formControlName="beneficiaryDestinationBank"
            placeholder="Enter destination bank"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('beneficiaryDestinationBank')?.touched && transferForm.get('beneficiaryDestinationBank')?.invalid">
            Destination Bank is required (max 100 characters)
          </small>
        </div>
        <div class="form-field">
          <label for="beneficiaryBankAccount" class="form-label">Bank Account</label>
          <input
            pInputText
            id="beneficiaryBankAccount"
            formControlName="beneficiaryBankAccount"
            placeholder="Enter bank account (optional)"
            class="form-input"
          />
          <small class="p-error" *ngIf="transferForm.get('beneficiaryBankAccount')?.touched && transferForm.get('beneficiaryBankAccount')?.invalid">
            Bank Account must not exceed 34 characters
          </small>
        </div>
      </div>
    </div>

    <!-- Documents -->
    <div class="form-section hover-glow smooth-transition">
      <h5 class="form-section-title">Documents</h5>
      <div class="file-upload-area">
        <p-fileUpload
          [multiple]="true"
          [maxFileSize]="1000000"
          accept="application/pdf,image/*"
          (onSelect)="onFileSelected($event)"
          [customUpload]="true"
          [files]="selectedFiles"
        ></p-fileUpload>
      </div>
      <div *ngIf="selectedFiles.length" class="mt-4 space-y-2">
        <h6 class="text-sm font-medium text-gray-700 dark:text-gray-300">Selected Documents</h6>
        <div *ngFor="let file of selectedFiles" class="file-item">
          <span class="file-name">{{ file.name }}</span>
          <button
            pButton
            pRipple
            icon="pi pi-trash"
            class="action-btn action-btn-delete"
            (click)="removeFile(file)"
          ></button>
        </div>
      </div>
    </div>
  </form>
</div>

<p-toast></p-toast>